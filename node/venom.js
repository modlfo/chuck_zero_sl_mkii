var midi = require('midi');


function Venom(){
  this.output = new midi.output();

  this.WavesNoDrums =
  ['HP Sine','PB Sine','RP Sine',
               'SH Tri',   'MG Tri',   'RP Tri',
   'PB Saw',   'SH Saw',   'MG Saw',   'OB Saw',   'JX Saw',   'RP Saw',   'MS Saw',
   'PB Square','SH Square','MG Square','OB Square','JX Square','RP Square','MS Square',
   'AL Pulse', 'MG Pulse',
   'MG Sync', 'SH Sync','JH Sync',
   'BitWave1','BitWave2','BitWave3',
   'ALFMWave','DPXWave','RPFMWave','ALFMBass','ALFMQuack','ALFMWoody',
   'ALFMScn', 'ALFMOrg1','ALFMOrg2','ALFMInh','MGWNoise'];

  this.msg18 = 0x00;

}


Venom.prototype.open = function(device)
  {
  /* Search the output port */
  var ports = this.output.getPortCount();
  for (var i = 0; i < ports; i++) {
    var name = this.output.getPortName(i);
    if(name.indexOf(device)>-1){
      this.output.openPort(i);
      console.log('Opening output '+name);
      break;
    }
  }
  };

  /*------------   VOICE    -------*/
Venom.prototype.setVoiceMonoPoly = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x6F,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setVoiceUnisonOnOff = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x70,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

  /* Note there are missing features for the voide configuration */

   /* ---------   OSCILLATORS ---------------*/

Venom.prototype.setOscDrift = function(drift)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x14,0x00,drift,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setOSCStartMod = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x13,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setOSCRingMod = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x16,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
  //------ Osc 1
Venom.prototype.setOsc1Wave = function(wave)
  {
    console.log('Setting the wave');
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x1A,0x00,wave,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc1Coarse = function(level)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x1B,0x00,level,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc1Fine = function(level)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x1C,0x00,level,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc1KeyTrack = function(on_off)
  {
    if(on_off!==0)
      this.msg18 = this.msg18 & (~0x08);
    else
      this.msg18 = this.msg18 | 0x08;
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x18,0x00,this.msg18,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOcs1To3FM = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x17,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOcs1WaveShape = function(val)
  {
    var msg = [];
    if(val!==0)
    {
      msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x19,0x00,val,0xF7];
      this.output.sendMessage(msg);
      this.msg18 = this.msg18 | 0x01;
      msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x18,0x00,this.msg18,0xF7];
      this.output.sendMessage(msg);
    }
    else
    {
      msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x19,0x7F,0x7F,0xF7];
      this.msg18 = this.msg18 & (~0x01);
      this.output.sendMessage(msg);
      msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x18,0x00,this.msg18,0xF7];
      this.output.sendMessage(msg);
    }
  };

  //------- Osc 2
Venom.prototype.setOsc2Wave = function(wave)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x1D,0x00,wave,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc2Coarse = function(level)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x1E,0x00,level,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc2Fine = function(level)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x1F,0x00,level,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc2KeyTrack = function(on_off)
  {
    if(on_off===0)
      this.msg18 = this.msg18 | 0x10;
    else
      this.msg18 = this.msg18 & (~0x10);
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x18,0x00,this.msg18,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc2Sync = function(on_off)
  {
    if(on_off!==0)
      this.msg18 = this.msg18 | 0x02;
    else
      this.msg18 = this.msg18 & (~0x02);
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x18,0x00,this.msg18,0xF7];
    this.output.sendMessage(msg);
  };

  //------- Osc 3
Venom.prototype.setOsc3Wave = function(wave)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x21,0x00,wave,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc3Coarse = function(level)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x22,0x00,wave,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc3Fine = function(level)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x23,0x00,wave,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc3KeyTrack = function(on_off)
  {
    if(on_off!==0)
      this.msg18 = this.msg18 | 0x20;
    else
      this.msg18 = this.msg18 & (~0x20);
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x18,0x00,this.msg18,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc3Sync = function(on_off)
  {
    if(on_off!==0)
      this.msg18 = this.msg18 | 0x04;
    else
      this.msg18 = this.msg18 & (~0x04);
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x18,0x00,this.msg18,0xF7];
    this.output.sendMessage(msg);
  };

  // ----- Mix

Venom.prototype.setOsc1Level = function(level)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x64,0x00,level,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc2Level = function(level)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x65,0x00,level,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setOsc3Level = function(level)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x66,0x00,level,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setExtLevel = function(level)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x67,0x00,level,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setExtSource = function(val)
  {
    if(val>6)
    {
      val = 6;
    }
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x68,0x00,wave,0xF7];
    this.output.sendMessage(msg);
  };

  /// ---- Pitch
Venom.prototype.setGlide = function(on_off)
  {
    var msg = [];

    if(on_off!==0)
    {
      msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x00,0x00,0x7F,0xF7];
    }
    else
    {
      msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x00,0x00,0x00,0xF7];
    }
    this.output.sendMessage(msg);
  };

Venom.prototype.setGlideRange = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x01,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setBendRange = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x15,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

   /// ----- Filter

Venom.prototype.setCutoff = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x6A,0x00,val,0xF7]
    this.output.sendMessage(msg);
    msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x6B,0x00,0x00,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setResonance = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x6C,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setBoost = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x20,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setFilterType = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x69,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

  // ------- Envelopes

Venom.prototype.setEnv1Attack = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x04,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv1Hold = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x05,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv1Decay = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x06,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv1Sustain = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x07,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv1Release = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x08,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv2Attack = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x09,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv2Hold = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x0A,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv2Decay = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x0B,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv2Sustain = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x0C,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv2Release = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x0D,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv3Attack = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x0E,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv3Hold = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x0F,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv3Decay = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x10,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv3Sustain = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x11,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setEnv3Release = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x12,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

  // Insert FX

Venom.prototype.setInsertFX = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x78,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setDirectLevel = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x75,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

  // Aux FX

Venom.prototype.setAuxFX1Level = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x76,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setAuxFX2Level = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x77,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

  // ---- LFO ---
Venom.prototype.setLFO1Wave = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x25,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setLFO1Rate = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x26,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setLFO1Delay = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x27,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setLFO1Attack = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x28,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setLFO1Start = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x29,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setLFO2Wave = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x2A,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setLFO2Rate = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x2B,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setLFO2Delay = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x2C,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setLFO2Attack = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x2D,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setLFO2Start = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x2E,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };



  // Modulation

Venom.prototype.setMod1Source = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x34,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod1Destination = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x44,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod1Amount = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x54,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setMod2Source = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x35,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod2Destination = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x45,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod2Amount = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x55,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

Venom.prototype.setMod3Source = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x36,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod3Destination = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x46,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod3Amount = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x56,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod4Source = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x37,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod4Destination = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x47,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod4Amount = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x57,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod5Source = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x38,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod5Destination = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x48,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod5Amount = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x58,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod6Source = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x39,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod6Destination = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x49,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };
Venom.prototype.setMod6Amount = function(val)
  {
    var msg = [0xF0,0x00,0x01,0x05,0x21,0x00,0x02,0x09,0x00,0x59,0x00,val,0xF7];
    this.output.sendMessage(msg);
  };

module.exports = Venom;